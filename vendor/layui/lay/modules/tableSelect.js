layui.define(["table","jquery","form"],function(exports){var MOD_NAME="tableSelect",$=layui.jquery,table=layui.table,form=layui.form;var tableInfo;var tableSelect=function(){this.v=tableInfo};tableSelect.prototype.render=function(opt){var elem=$(opt.elem);var tableDone=opt.table.done||function(){};opt.checkedKey=opt.checkedKey;opt.table.page=opt.table.page||true;opt.table.height=opt.table.height||315;elem.off("click").on("click",function(e){e.stopPropagation();if($("div.tableSelect").length>=1){return false}var t=elem.offset().top+elem.outerHeight()+"px";var l=elem.offset().left+"px";var tableName="tableSelect_table_"+new Date().getTime();var tableBox='<div class="tableSelect layui-anim layui-anim-upbit" style="left:'+l+";top:"+t+';border: 1px solid #d2d2d2;background-color: #fff;box-shadow: 0 2px 4px rgba(0,0,0,.12);padding:10px 10px 0 10px;position: absolute;z-index:66666666;margin: 5px 0;border-radius: 2px;width:530px;">';tableBox+='<div class="tableSelectBar">';tableBox+="</div>";tableBox+='<table id="'+tableName+'" lay-filter="'+tableName+'"></table>';tableBox+="</div>";tableBox=$(tableBox);$("body").append(tableBox);var checkedData=[];opt.table.elem="#"+tableName;opt.table.id=tableName;opt.table.done=function(res,curr,count){defaultChecked(res,curr,count);tableDone(res,curr,count)};table.render(opt.table);tableInfo=opt.table;table.on("radio("+tableName+")",function(obj){if(opt.checkedKey){checkedData=table.checkStatus(tableName).data}});function defaultChecked(res,curr,count){}var overHeight=(elem.offset().top+elem.outerHeight()+tableBox.outerHeight()-$(window).scrollTop())>$(window).height();var overWidth=(elem.offset().left+tableBox.outerWidth())>$(window).width();overHeight&&tableBox.css({"top":"auto","bottom":"0px"});overWidth&&tableBox.css({"left":"auto","right":"5px"});table.on("row("+tableName+")",function(obj){var checkStatus={data:[obj.data]};selectDone(checkStatus)});function selectDone(checkStatus){if(opt.checkedKey){var selected=[];for(var i=0;i<checkStatus.data.length;i++){selected.push(checkStatus.data[i].garageName)}$(elem).val(selected)}opt.done(elem,checkStatus);tableBox.remove();delete table.cache[tableName];checkedData=[]}$(document).mouseup(function(e){var userSet_con=$(""+opt.elem+",.tableSelect");if(!userSet_con.is(e.target)&&userSet_con.has(e.target).length===0){tableBox.remove();delete table.cache[tableName];checkedData=[]}})})};tableSelect.prototype.hide=function(opt){$(".tableSelect").remove()};var tableSelect=new tableSelect();if(window.top==window.self){$(window).scroll(function(){tableSelect.hide()})}exports(MOD_NAME,tableSelect)});
